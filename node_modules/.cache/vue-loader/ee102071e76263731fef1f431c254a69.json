{"remainingRequest":"/Users/mac/Desktop/save-pets-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/Desktop/save-pets-ui/src/views/find-location-view.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/Users/mac/Desktop/save-pets-ui/src/views/find-location-view.vue","mtime":1598014449364},{"path":"/Users/mac/Desktop/save-pets-ui/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/save-pets-ui/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/mac/Desktop/save-pets-ui/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/mac/Desktop/save-pets-ui/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/save-pets-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/save-pets-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZmluZC1sb2NhdGlvbi12aWV3X19tYXAgewogIGZsZXg6IDEgMDsKfQoKLmZpbmQtbG9jYXRpb24tdmlld19fYm90dG9tLWJhciB7CiAgaGVpZ2h0OiAxODVweDsKICBwYWRkaW5nOiAxNXB4IDE1cHggMjNweDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodC0xMDApOwp9Cg=="},{"version":3,"sources":["find-location-view.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6HA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"find-location-view.vue","sourceRoot":"src/views","sourcesContent":["<script>\nimport {gmapApi} from \"vue2-google-maps\";\nimport * as views from \"../lib/views-list\";\nimport ManualLocation from \"../components/manual-location.vue\";\nimport SButton from \"../components/s-button.vue\";\n\nexport default {\n  name: \"find-location-view\",\n\n  components: {\n    ManualLocation,\n    SButton,\n  },\n\n  data: () => ({\n    coords: {\n      lat: 50.4,\n      lng: 30.6,\n    },\n    isCoordsEntered: false,\n    inputLocation: \"\",\n    zoom: 17,\n  }),\n\n  computed: {\n    google: gmapApi,\n    isValidCoords() {\n      return !!this.coords.lat && !!this.coords.lng && this.isCoordsEntered;\n    },\n  },\n\n  mounted() {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(({coords}) => {\n        const {latitude: lat, longitude: lng} = coords;\n        this.coords = {lng, lat};\n\n        this.coordsEntered();\n        this.runGeocode();\n      }, this.coordsDenied);\n    }\n  },\n\n  methods: {\n    runGeocode() {\n      const geocoder = new this.google.maps.Geocoder();\n\n      geocoder.geocode({location: this.coords}, (results, status) => {\n        if (status === \"OK\" && results.length) {\n          const [geo] = results;\n          const [number, street] = geo.address_components;\n\n          this.inputLocation = `${street.short_name}, ${number.short_name}`;\n\n          this.coordsEntered();\n        }\n      });\n    },\n    changeAddress(geo) {\n      const {location} = geo.geometry;\n\n      this.coords = {\n        lat: location.lat(),\n        lng: location.lng(),\n      };\n\n      this.inputLocation = `${geo.name}, ${geo.vicinity}`;\n      this.coordsEntered();\n    },\n    coordsEntered() {\n      if (!this.isCoordsEntered) {\n        this.isCoordsEntered = true;\n      }\n    },\n    coordsDenied(err) {\n      console.log(err);\n    },\n    handleChangeView() {\n      this.$emit(\"change-view\", views.SET_INFO_VIEW);\n    },\n  },\n};\n</script>\n\n<template>\n  <div class=\"view find-location-view\">\n    <div class=\"find-location-view__map\">\n      <google-map\n        :center=\"coords\"\n        :zoom=\"zoom\"\n        :options=\"{\n          zoomControl: false,\n          mapTypeControl: false,\n          fullscreenControl: false,\n          streetViewControl: false,\n        }\"\n        map-type-id=\"terrain\"\n        style=\"width: 100%; height: 100%\"\n      >\n        <google-map-marker\n          :position=\"coords\"\n          :icon=\"{\n            url: require('../assets/placeholder.svg')\n          }\"\n        />\n      </google-map>\n    </div>\n\n    <div class=\"find-location-view__bottom-bar\">\n      <manual-location\n        :value=\"inputLocation\"\n        @change=\"changeAddress\"\n      >\n        <s-button\n          :disabled=\"!isCoordsEntered\"\n          @click=\"handleChangeView\"\n        >\n          Знайшов тварину\n        </s-button>\n      </manual-location>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\">\n.find-location-view__map {\n  flex: 1 0;\n}\n\n.find-location-view__bottom-bar {\n  height: 185px;\n  padding: 15px 15px 23px;\n  background: var(--light-100);\n}\n</style>\n"]}]}